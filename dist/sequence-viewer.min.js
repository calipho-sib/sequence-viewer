var Sequence;(()=>{var e={954:e=>{"object"==typeof e.exports&&(e.exports=function(e,t){var n,r=this;this.events={MOUSE_SELECTION_EVENT:"sequence-viewer-mouse-selection",SEQUENCE_SELECTED_EVENT:"sequence-viewer-substring-selected"},n=void 0!==t?t:"",console.log(n),e=e;var s,a,o="",l="",d={data:[],start:null,end:null,hlColor:null},c={};function p(e,t,n){(new Date).getTime(),0===e.length&&$(s+" .fastaSeq").html(o);var r=o.toString(),a=0,l=0;for(i in e)a=g(e[i].start),l=g(e[i].end),r=r.substring(0,a)+"<span class='stringsSelected' style=\"background:"+t+';color:white;">'+r.substring(a,l)+"</span>"+r.substring(l,r.length);$(s+" .fastaSeq").html(r)}function g(e){return e+~~(e/10)+4*~~(e/c.charsPerLine)}function h(t){var n=function(e,t){var n=[];return e.length&&e.forEach((function(e){n.push({start:e.start+1,end:e.end,sequence:t.substring(e.start,e.end)})})),n}(t,e);n&&function(e){if(CustomEvent){var t=new CustomEvent(r.events.SEQUENCE_SELECTED_EVENT,{detail:e});a.dispatchEvent(t)}else console.warn("CustomEvent is not defined....");r.trigger&&r.trigger(r.events.SEQUENCE_SELECTED_EVENT,e)}(n)}this.render=function(t,i){if("string"!=typeof t)throw new Error("Div identifier must be a string");if(s=t,null===(a=document.getElementById(t.substring(1))))throw new Error("Cannot find element with id: "+t.substring(1));i||(i={}),c.showLineNumbers=void 0===i.showLineNumbers||i.showLineNumbers,c.wrapAminoAcids=void 0===i.wrapAminoAcids||i.wrapAminoAcids,c.sequenceMaxHeight=void 0===i.sequenceMaxHeight?"400px":i.sequenceMaxHeight,c.title=void 0===i.title?"Protein Sequence":i.title,c.charsPerLine=void 0===i.charsPerLine?30:i.charsPerLine,c.search=void 0!==i.search&&i.search,c.toolbar=void 0!==i.toolbar&&i.toolbar,c.badge=void 0===i.badge||i.badge,c.fasta=void 0===i.fasta||i.fasta,c.apiURL=void 0===i.apiURL||i.apiURL,c.blast=void 0===i.blast||i.blast,c.digestion=void 0!==i.digestion&&i.digestion,c.header=i.header?{display:void 0===i.header.display||i.header.display,searchInTitle:void 0===i.header.searchInTitle||i.header.searchInTitle,unit:void 0===i.header.unit?"Char":i.header.unit,showCpl:void 0===i.header.showCpl||i.header.showCpl,badgeWithUnit:void 0!==i.header.badgeWithUnit&&i.header.badgeWithUnit}:{display:!0,searchInTitle:!0,unit:"Char",showCpl:!0,badgeWithUnit:!1};var g,u,v='<div style="display:inline-block;"><span class="badge" style="border-radius:70%;border: 2px solid black;color:#C50063;padding:8px 5px;background-color:white;margin-right:10px;vertical-align:middle;min-width:32px;">'+e.length+"</span></div>",b='<div style="display:inline-block;"><span class="badge" style="border-radius:70%;border: 2px solid black;color:#C50063;padding:5px 5px;background-color:white;margin-right:10px;vertical-align:middle;min-width:32px;font-size:11px;">'+e.length+"<div style='margin-top:-2px;font-size:9px;color:black;text-transform:lowercase;'>"+c.header.unit+"</div></span></div>",f=c.badge?c.header.badgeWithUnit?b:v:"",m=(c.header.display?'<div class="sequenceHeader row" style="border-bottom: 1px solid #E7EAEC;padding-bottom:5px;margin:0px 0px 10px">'+f+'<h4 style="display:inline-block;vertical-align:middle;">'+c.title+"</h4></div>":"")+'<div class="sequenceBody" style="margin-top: 5px;"><div class="scroller" style="max-height:'+c.sequenceMaxHeight+';overflow:auto;white-space: nowrap;padding-right:20px;margin-right:10px;"><div class="charNumbers" style="font-family: monospace;font-size: 13px;display:inline-block;text-align:right; padding-right:5px; border-right:1px solid LightGray;"></div><div class="fastaSeq" display-option="'+c.charsPerLine+'" style="font-family: monospace;font-size: 13px;display:inline-block;padding:5px;">'+e+'</div></div><div class="coverageLegend" style="margin-top: 10px;margin-left:15px;"></div></div>';if($(t).html(m),c.wrapAminoAcids?function(e){var t=parseInt($(e).attr("display-option"));t=(t+t/10).toString();var n=$(e).html();n=n.toString().match(/.{1,10}/g).join(" ").match(new RegExp(".{1,"+t+"}","g")).join("<br>"),l=n,$(e).html(n)}(t+" .fastaSeq"):$(t+" .scroller").css("overflow-x","auto"),c.showLineNumbers&&function(e,t){for(var n=$(e).html().split("<br>"),i=parseInt($(e).attr("display-option")),r=[],s=0,a=0;a<n.length;a++)r.push(s+1+"<br>"),s+=i;$(t).html(r.join(""))}(t+" .fastaSeq",t+" .charNumbers"),c.toolbar&&(c.header.showCpl?(u='<form class="form-inline" style="margin-bottom:5px;"><div class="form-group form-group-sm sequenceToolbar" style=""> <label class="control-label charPerLine-label '+(g=n?"hidden-xs":"")+"\" for='"+s.substring(1)+"-cpl' style='margin-right:5px;'>"+c.header.unit+' per line</label><select class="CPLChoice form-control '+g+"\" id='"+s.substring(1)+"-cpl' style='display:inline-block;width:auto;margin-right:10px;'><option>Select</option><option value=50>50</option><option value=60>60</option><option value=70>70</option><option value=80>80</option><option value=90>90</option><option value=100>100</option></select></div></form>",$(s+" .sequenceBody").prepend(u),$(s+" .CPLChoice").change((function(){var e;e=this,c.charsPerLine=e.value,r.render(s,c),d.data.length&&r.coverage(d.data,d.start,d.end,d.hlColor),$(s+" .CPLChoice option:selected").text($(this).val())}))):$(s+" .sequenceBody").prepend('<form class="form-inline" style="margin-bottom:5px;"><div class="form-group form-group-sm sequenceToolbar" style=""> </div></form>'),""!==n)){if(c.fasta){var x="https://www.nextprot.org";c.apiURL&&(x=c.apiURL),$(s+" .sequenceToolbar").append('<a class="btn btn-default btn-sm fasta-link" href="'+x+"/isoform/"+n+".fasta\" target='_blank'>View FASTA</a>")}c.blast&&$(s+" .sequenceToolbar").append('<a class="btn btn-default btn-sm" href="/blast/'+n+'" style="margin-left:5px;">Blast sequence</a><a id="selectionBlast" class="btn btn-default btn-sm" href="/blast/'+n+'" style="margin-left:5px;"> Blast selection</a>'),c.digestion&&$(s+" .sequenceToolbar").append('<a class="btn btn-default btn-sm" href="/tools/protein-digestion/'+n+'" style="margin-left:5px;"> Digest </a>')}c.search&&(c.header.searchInTitle?$(s+" .sequenceHeader").append('<input class="inputSearchSeq form-control pull-right" type="text" style="width:40%;margin-top: 3px;" placeholder="Search in sequence.. (Regex supported)">'):$(s+" .sequenceBody").prepend('<input class="inputSearchSeq form-control" type="text" style="width:100%;margin:3px auto 10px;" placeholder="Search in sequence.. (Regex supported)">'),$(s+" .inputSearchSeq").keyup((function(){var t=$(this).val().replace(/\s/g,"");if(/\S/.test(t)){for(var i,r=new RegExp(t,"gi"),a=[];null!=(i=r.exec(e));)a.push({start:i.index,end:i.index+i[0].length});a.sort((function(e,t){return t.start-e.start})),h(a),p(a,"#C50063"),a&&$("#selectionBlast").attr("href","/blast/"+n+"/"+a[0].start+"/"+a[0].end+"/")}else $(s+" .fastaSeq").html(l)}))),o=$(t+" .fastaSeq").html(),$(s+" .fastaSeq").mouseup((function(){var e=function(){var e=window.getSelection().toString().replace(/\s+/g,""),t=window.getSelection(),n=$(s+" .fastaSeq")[0],i=0,r=$(s+" .fastaSeq").text(),a=t.getRangeAt(0),o=a.cloneRange();o.selectNodeContents(n),o.setEnd(a.endContainer,a.endOffset),i=o.toString().length;var l=r.substring(0,i).replace(/\s+/g,"").length;return{text:e,start:l-(e.length-1),end:l}}();e&&e.start<=e.end&&(function(e){if(CustomEvent){var t=new CustomEvent(r.events.MOUSE_SELECTION_EVENT,{detail:{selection:e.text,start:e.start,end:e.end}});a.dispatchEvent(t)}else console.warn("CustomEvent is not defined....");r.trigger&&r.trigger(r.events.MOUSE_SELECTION_EVENT,{selection:e})}(e),p([{start:e.start-1,end:e.end}],"#C50063"),c.blast&&$("#selectionBlast").attr("href","/blast/"+n+"/"+e.start+"/"+e.end+"/"))}))},this.selection=function(e,t,i,r){var a=[e,t],l=o;h([{start:e,end:t}]),a[0]=a[0]+~~(a[0]/10)+4*~~(a[0]/c.charsPerLine),a[1]=a[1]+~~(a[1]/10)+4*~~(a[1]/c.charsPerLine),l=l.substring(0,a[0])+"<span class='stringSelected' style=\"background:"+i+';color:white;">'+l.substring(a[0],a[1])+"</span>"+l.substring(a[1],l.length),$(s+" .fastaSeq").html(l),c.blast&&$("#selectionBlast").attr("href","/blast/"+n+"/"+(e+1)+"/"+t+"/")},this.addLegend=function(e){for(var t=0;t<e.length;t++)!0===e[t].underscore?$(s+" .coverageLegend").append('<div style="display:inline-block;background:'+e[t].color+';width:20px;height:20px;vertical-align:middle;margin:0px 5px 0px 10px;border-radius:50%; border: 1px solid grey;text-align:center; line-height:0.8;">_</div><p style="display:inline-block;font-weight:bold;font-size:11px;font-style:italic;margin:0;padding-top:3px;vertical-align:top;">'+e[t].name+"</p></div>"):$(s+" .coverageLegend").append('<div style="display:inline-block;background:'+e[t].color+';width:20px;height:20px;vertical-align:middle;margin:0px 5px 0px 10px;border-radius:50%;"></div><p style="display:inline-block;font-weight:bold;font-size:11px;font-style:italic;margin:0;padding-top:3px;vertical-align:top;">'+e[t].name+"</p>")},this.coverage=function(t,n,i,r){d.data=jQuery.extend(!0,[],t),d.start=n,d.end=i,d.hlColor=r,t.sort((function(e,t){return e.start-t.start})),t=function(t){for(var n=t.slice(),i=0;i<=t.length-1;i++)0===i?(t[0].start>0&&n.unshift({start:0,end:t[0].start,color:"black",underscore:!1}),i===t.length-1&&n.push({start:t[i].end,end:e.length,color:"black",underscore:!1})):i===t.length-1?(t[i-1].end<t[i].start&&n.push({start:t[i-1].end,end:t[i].start,color:"black",underscore:!1}),t[i].end<e.length-1&&n.push({start:t[i].end,end:e.length,color:"black",underscore:!1})):t[i-1].end<t[i].start&&n.push({start:t[i-1].end,end:t[i].start,color:"black",underscore:!1}),0!==i&&t[i-1].end>t[i].start&&console.warn("WARNING (error): Some positions in the coverage list are overlapping");return n.sort((function(e,t){return e.start-t.start})),n}(t),(new Date).getTime(),n||(n=0),i||(i=0),r||(r="#FFE5A3");for(var a="",c="",p=0;p<t.length;p++){var h="";void 0!==t[p].tooltip&&(h=' title="'+t[p].tooltip+'"');var u="";void 0!==t[p].bgcolor&&(u="background:"+t[p].bgcolor+";");var v="",b="";void 0!==t[p].onclick&&(v=' onclick=" return '+p+';" ',b="cursor: pointer;"),t[p].underscore?a+=c='<span style="text-decoration:underline;color:'+t[p].color+";"+u+b+'"'+h+v+">":a+=c='<span style="color:'+t[p].color+";"+u+b+'"'+h+v+">",i?n>=t[p].start&&n<t[p].end&&i>=t[p].start&&i<t[p].end?(a+=o.substring(g(t[p].start),g(n))+'<span class="peptideHighlighted" style="background:'+r+';">'+o.substring(g(n),g(i+1)),a+="</span>"+o.substring(g(i+1),g(t[p].end))+"</span>"):n>=t[p].start&&n<t[p].end?a+=o.substring(g(t[p].start),g(n))+'</span><span class="peptideHighlighted" style="background:'+r+';">'+c+o.substring(g(n),g(t[p].end))+"</span>":i>=t[p].start&&i<t[p].end?a+=o.substring(g(t[p].start),g(i+1))+"</span></span>"+c+o.substring(g(i+1),g(t[p].end))+"</span>":a+=o.substring(g(t[p].start),g(t[p].end))+"</span>":a+=o.substring(g(t[p].start),g(t[p].end))+"</span>"}var f=$(s+" .fastaSeq");f.html(a),l=a;var m=$("[onclick]",f);for(p=0;p<m.length;p++){var x=m[p].onclick();m[p].onclick=t[x].onclick}},this.onMouseSelection=function(e){a.addEventListener(r.events.MOUSE_SELECTION_EVENT,e)},this.onSubpartSelected=function(e){a.addEventListener(r.events.SEQUENCE_SELECTED_EVENT,e)}})}},t={};var n=function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}(954);Sequence=n})();